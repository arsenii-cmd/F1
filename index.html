<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 ‚Äî –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</title>
    <link rel="stylesheet" href="styles.css">

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#cc0000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" href="icons/icon.svg" type="image/svg+xml">
</head>
<body>
    <!-- === –®–ê–ü–ö–ê === -->
    <header>
        <img src="https://i.vimeocdn.com/video/669065538-41fafaad781845ba3a564d44ea530cd5a24597b6f20f3b274b61833f401256d2-d?f=webp" alt="F1 Background" class="header-bg">
        <div class="header-content">
            <nav>
                <button onclick="showSection('races')">–ì–æ–Ω–∫–∏</button>
                <button onclick="showSection('drivers')">–õ–∏—á–Ω—ã–π –∑–∞—á—ë—Ç</button>
                <button onclick="showSection('constructors')">–ö—É–±–æ–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤</button>
                <button onclick="showSection('broadcasts')">–¢—Ä–∞–Ω—Å–ª—è—Ü–∏–∏</button>
                <button id="refreshButton" onclick="refreshData()">–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </nav>
            <div class="year-selector">
                <span class="year-label">–°–µ–∑–æ–Ω:</span>
                <button class="year-btn" data-year="2023" onclick="changeSeason(2023)">2023</button>
                <button class="year-btn" data-year="2024" onclick="changeSeason(2024)">2024</button>
                <button class="year-btn" data-year="2025" onclick="changeSeason(2025)">2025</button>
                <button class="year-btn active" data-year="2026" onclick="changeSeason(2026)">2026</button>
            </div>
        </div>
    </header>

    <!-- === –°–¢–ê–¢–£–° API === -->
    <div id="apiStatus"></div>

    <!-- === –°–ï–ö–¶–ò–ò === -->
    <div id="races" class="section">
        <h2 id="racesHeading">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥–æ–Ω–æ–∫ ‚Äî –°–µ–∑–æ–Ω 2026</h2>
        <div id="racesError" class="error" style="display:none;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –≥–æ–Ω–∫–∞—Ö.</div>
        <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>–≠—Ç–∞–ø</th>
                    <th>–î–∞—Ç–∞</th>
                    <th>–°—Ç—Ä–∞–Ω–∞</th>
                    <th>–¢—Ä–∞—Å—Å–∞</th>
                    <th>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –≥–æ–Ω–∫–∏</th>
                    <th>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å —Å–ø—Ä–∏–Ω—Ç–∞</th>
                </tr>
            </thead>
            <tbody id="racesTableBody"></tbody>
        </table>
        </div>
    </div>

    <div id="drivers" class="section hidden">
        <h2 id="driversHeading">–õ–∏—á–Ω—ã–π –∑–∞—á—ë—Ç ‚Äî –°–µ–∑–æ–Ω 2026</h2>
        <div id="driversError" class="error" style="display:none;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –ø–∏–ª–æ—Ç–∞—Ö.</div>
        <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>–ü–æ–∑–∏—Ü–∏—è</th>
                    <th>–ì–æ–Ω—â–∏–∫</th>
                    <th class="col-nationality">–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</th>
                    <th>–ö–æ–º–∞–Ω–¥–∞</th>
                    <th>–û—á–∫–∏</th>
                </tr>
            </thead>
            <tbody id="driversTableBody"></tbody>
        </table>
        </div>
    </div>

    <div id="constructors" class="section hidden">
        <h2 id="constructorsHeading">–ö—É–±–æ–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ ‚Äî –°–µ–∑–æ–Ω 2026</h2>
        <div id="constructorsError" class="error" style="display:none;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞—Ö.</div>
        <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>–ü–æ–∑–∏—Ü–∏—è</th>
                    <th>–ö–æ–º–∞–Ω–¥–∞</th>
                    <th>–û—á–∫–∏</th>
                </tr>
            </thead>
            <tbody id="constructorsTableBody"></tbody>
        </table>
        </div>
    </div>

    <!-- === –¢–†–ê–ù–°–õ–Ø–¶–ò–ò === -->
    <div id="broadcasts" class="section hidden">
        <h2>–¢—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –∏ —Å—Å—ã–ª–∫–∏</h2>

        <div class="table-wrapper">
        <table class="links-table">
            <tbody>
                <tr>
                    <td class="label-cell">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç F1</td>
                    <td class="link-cell"><a href="https://www.formula1.com/" target="_blank">formula1.com</a></td>
                </tr>
                <tr>
                    <td class="label-cell">–¢—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º</td>
                    <td class="link-cell"><a href="https://rutube.ru/u/versporta/" target="_blank">RUTUBE: –í–µ—Ä—à–∏–Ω–∞ –ê–≤—Ç–æ—Å–ø–æ—Ä—Ç–∞</a></td>
                </tr>
                <tr>
                    <td class="label-cell">Telegram-–∫–∞–Ω–∞–ª</td>
                    <td class="link-cell"><a href="https://t.me/formula_1_news" target="_blank">@formula_1_news</a></td>
                </tr>
            </tbody>
        </table>
        </div>

        <h3 style="margin-top: 30px;">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∞–π—Ç—ã –∫–æ–º–∞–Ω–¥ 2026</h3>
        <div class="table-wrapper">
        <table class="links-table teams-table">
            <tbody>
                <tr>
                    <td class="logo-cell"><a href="https://www.mclaren.com/racing/formula-1/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/mclaren-logo.png" onerror="this.style.display='none'" alt="McLaren" class="team-logo-small"></a></td>
                    <td class="team-name-cell">McLaren</td>
                    <td class="team-link-cell"><a href="https://www.mclaren.com/racing/formula-1/" target="_blank">mclaren.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.ferrari.com/en-EN/formula1" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/ferrari-logo.png" onerror="this.style.display='none'" alt="Ferrari" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Ferrari</td>
                    <td class="team-link-cell"><a href="https://www.ferrari.com/en-EN/formula1" target="_blank">ferrari.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.mercedesamgf1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/mercedes-logo.png" onerror="this.style.display='none'" alt="Mercedes" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Mercedes</td>
                    <td class="team-link-cell"><a href="https://www.mercedesamgf1.com/" target="_blank">mercedesamgf1.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.redbullracing.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/red-bull-racing-logo.png" onerror="this.style.display='none'" alt="Red Bull" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Red Bull Racing</td>
                    <td class="team-link-cell"><a href="https://www.redbullracing.com/" target="_blank">redbullracing.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.williamsf1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/williams-logo.png" onerror="this.style.display='none'" alt="Williams" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Williams</td>
                    <td class="team-link-cell"><a href="https://www.williamsf1.com/" target="_blank">williamsf1.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.visacashapprb.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/racing-bulls-logo.png" onerror="this.style.display='none'" alt="Racing Bulls" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Racing Bulls</td>
                    <td class="team-link-cell"><a href="https://www.visacashapprb.com/" target="_blank">visacashapprb.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.astonmartinf1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/aston-martin-logo.png" onerror="this.style.display='none'" alt="Aston Martin" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Aston Martin</td>
                    <td class="team-link-cell"><a href="https://www.astonmartinf1.com/" target="_blank">astonmartinf1.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.haasf1team.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/haas-logo.png" onerror="this.style.display='none'" alt="Haas" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Haas</td>
                    <td class="team-link-cell"><a href="https://www.haasf1team.com/" target="_blank">haasf1team.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.alpinef1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/alpine-logo.png" onerror="this.style.display='none'" alt="Alpine" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Alpine</td>
                    <td class="team-link-cell"><a href="https://www.alpinef1.com/" target="_blank">alpinef1.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.audimotorsport.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/audi-logo.png" onerror="this.style.display='none'" alt="Audi" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Audi</td>
                    <td class="team-link-cell"><a href="https://www.audimotorsport.com/" target="_blank">audimotorsport.com</a></td>
                </tr>
                <tr>
                    <td class="logo-cell"><a href="https://www.andretti.com/f1" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/cadillac-logo.png" onerror="this.style.display='none'" alt="Cadillac" class="team-logo-small"></a></td>
                    <td class="team-name-cell">Cadillac</td>
                    <td class="team-link-cell"><a href="https://www.andretti.com/f1" target="_blank">andretti.com/f1</a></td>
                </tr>
            </tbody>
        </table>
        </div>
    </div>

    <!-- === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û === -->
    <div id="raceResultsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">√ó</span>
            <h2 id="modalTitle">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–Ω–∫–∏</h2>

            <!-- –í–∫–ª–∞–¥–∫–∏ (–≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Å–ø—Ä–∏–Ω—Ç) -->
            <div class="modal-tabs" id="modalTabs" style="display:none;">
                <button class="modal-tab active" id="tabRace" onclick="switchModalTab('race')">–ì–æ–Ω–∫–∞</button>
                <button class="modal-tab" id="tabSprint" onclick="switchModalTab('sprint')">–°–ø—Ä–∏–Ω—Ç</button>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–Ω–∫–∏ -->
            <div id="raceResultsContainer">
                <div id="modalError" class="error" style="display:none;"></div>
                <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>–ü–æ–∑–∏—Ü–∏—è</th>
                            <th>–ì–æ–Ω—â–∏–∫</th>
                            <th>–ö–æ–º–∞–Ω–¥–∞</th>
                            <th>–û—á–∫–∏</th>
                        </tr>
                    </thead>
                    <tbody id="raceResultsTableBody"></tbody>
                </table>
                </div>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–ø—Ä–∏–Ω—Ç–∞ -->
            <div id="sprintResultsContainer" style="display:none;">
                <div id="sprintModalError" class="error" style="display:none;"></div>
                <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>–ü–æ–∑–∏—Ü–∏—è</th>
                            <th>–ì–æ–Ω—â–∏–∫</th>
                            <th>–ö–æ–º–∞–Ω–¥–∞</th>
                            <th>–û—á–∫–∏</th>
                        </tr>
                    </thead>
                    <tbody id="sprintResultsTableBody"></tbody>
                </table>
                </div>
            </div>
        </div>
    </div>

    <!-- === –§–£–¢–ï–† === -->
    <footer>
        <p id="footerText">¬© 2026 F1 Visualization Project ‚Äî –°–µ–∑–æ–Ω 2026 | –î–∞–Ω–Ω—ã–µ: Jolpica/Ergast API</p>
        <div class="team-logos">
            <a href="https://www.mclaren.com/racing/formula-1/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/mclaren-logo.png" onerror="this.style.display='none'" alt="McLaren" title="McLaren"></a>
            <a href="https://www.ferrari.com/en-EN/formula1" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/ferrari-logo.png" onerror="this.style.display='none'" alt="Ferrari" title="Ferrari"></a>
            <a href="https://www.mercedesamgf1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/mercedes-logo.png" onerror="this.style.display='none'" alt="Mercedes" title="Mercedes"></a>
            <a href="https://www.redbullracing.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/red-bull-racing-logo.png" onerror="this.style.display='none'" alt="Red Bull" title="Red Bull"></a>
            <a href="https://www.williamsf1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/williams-logo.png" onerror="this.style.display='none'" alt="Williams" title="Williams"></a>
            <a href="https://www.visacashapprb.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/racing-bulls-logo.png" onerror="this.style.display='none'" alt="Racing Bulls" title="Racing Bulls"></a>
            <a href="https://www.astonmartinf1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/aston-martin-logo.png" onerror="this.style.display='none'" alt="Aston Martin" title="Aston Martin"></a>
            <a href="https://www.haasf1team.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/haas-logo.png" onerror="this.style.display='none'" alt="Haas" title="Haas"></a>
            <a href="https://www.alpinef1.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/alpine-logo.png" onerror="this.style.display='none'" alt="Alpine" title="Alpine"></a>
            <a href="https://www.audimotorsport.com/" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/audi-logo.png" onerror="this.style.display='none'" alt="Audi" title="Audi"></a>
            <a href="https://www.andretti.com/f1" target="_blank"><img src="https://www.formula1.com/content/dam/fom-website/teams/2026/cadillac-logo.png" onerror="this.style.display='none'" alt="Cadillac" title="Cadillac"></a>
        </div>
    </footer>

    <script src="script.js"></script>

    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä–∞ (PWA) -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => {
                        console.log('[PWA] Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', reg.scope);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
                        setInterval(() => {
                            reg.update();
                        }, 60000);
                        
                        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                        reg.addEventListener('updatefound', () => {
                            const newWorker = reg.installing;
                            console.log('[PWA] –ù–∞–π–¥–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º...');
                            
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    console.log('[PWA] –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º...');
                                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                                    const statusEl = document.getElementById('apiStatus');
                                    if (statusEl) {
                                        statusEl.className = 'openf1';
                                        statusEl.style.display = 'block';
                                        statusEl.textContent = 'üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è... –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫';
                                    }
                                    setTimeout(() => {
                                        window.location.reload();
                                    }, 2000);
                                }
                            });
                        });
                    })
                    .catch(err => console.warn('[PWA] –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ SW:', err));
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç SW
                navigator.serviceWorker.addEventListener('controllerchange', () => {
                    console.log('[PWA] –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏–∑–º–µ–Ω—ë–Ω, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É');
                    window.location.reload();
                });
            });
        }
    </script>
</body>
</html>
